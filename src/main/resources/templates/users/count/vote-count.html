<!DOCTYPE html>
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xmlns:th="http://www.thymeleaf.org" layout:decorate="~{common/layout.html}">
<head>
  <title>투표 하기</title>
</head>

<section layout:fragment="content">
  <div class="container p-3">
    <div class="card">
      <div class="card-header">
        <h3 class="fw-bold text-center">투표 하기</h3>
      </div>
      <div class="card-body">
        <form th:object="${voteBoxDto}" th:action="@{/users/save}" method="post" class="text-center">
          <input type="hidden" name="usersPhone" th:value="${usersPhone}" >
          <input type="hidden" th:value="${detailVote.electionId}" name="electionId">
          <input type="hidden" th:value="${detailVote.voteId}" name="voteId">
          <input type="hidden" th:value="${detailVote.voteType}" name="voteType">
          <input type="hidden" id="hadVoted" name="hadVoted" value="true">
          <p class="card-text" th:text="'투표명: ' + ${detailVote.voteTitle}"></p>

          <div th:each="candidate : ${detailCand}">
            <input type="hidden" th:value="${candidate.candidateId}" name="candidateId" />
            <div>
            <p class="card-text" th:text="'후보자명: ' + ${candidate.candidateName}"></p>
            <p class="card-text" th:text="'후보자정보: ' + ${candidate.candidateInfo}"></p>
            </div>
          </div>
          <div>
          <p class="card-text" th:text="'투표 종류: ' + ${detailVote.voteType}"></p>
          </div>

          <div th:if="${#strings.equals(detailVote.voteType, 'PROS_CONS')}">
            <label for="hadChosen">찬성</label>
            <input type="radio" id="hadChosen" name="hadChosen" value="true" checked>
            <label for="unChosen">반대</label>
            <input type="radio" id="unChosen" name="hadChosen" value="false">
          </div>

          <div th:if="${#strings.equals(detailVote.voteType, 'CHOICE')}">
            <div th:each="candidate : ${detailCand}">
              <label th:for="'candidate-' + ${candidate.candidateId}" th:text="${candidate.candidateName}"></label>
              <input type="checkbox" th:id="'candidate-' + ${candidate.candidateId}" th:field="*{hadChosen}" th:value="${candidate.candidateId}" />
            </div>
          </div>


          <div th:if="${#strings.equals(detailVote.voteType, 'SCORE')}">
            <div th:each="candidate : ${detailCand}">
              <label th:for="scores" th:text="${candidate.candidateName}"></label>
              <input type="text" th:id="'candidate-' + ${candidate.candidateId}" th:field="*{scores}" />
            </div>
          </div>


            <div th:if="${#strings.equals(detailVote.voteType, 'PREFERENCE')}">
            <div th:each="candidate : ${detailCand}">
              <label th:for="ranks" th:text="${candidate.candidateName}"></label>
              <input type="number" th:id="'candidate-' + ${candidate.candidateId}" th:field="*{ranks}" />
            </div>
          </div>

          <button class="btn btn-secondary" type="submit">투표 하기</button>
        </form>

      </div>
    </div>
  </div>
</section>
</html>